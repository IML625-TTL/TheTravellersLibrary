<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Useful Links - The Traveller's Library</title>

    <!-- MAIN CSS -->
    <link rel="stylesheet" href="Useful Links.css"><link rel="icon" href="../../Favicon TTL (Y).ico" type="image/x-icon">
</head>

<body>

<!-- NAVBAR -->
    <nav id="navbar">
        <div class="nav-left">
            <div class="logo">
                <a href="../../index.html" target="_blank">
                    <img src="../../Index Visuals/Navbar/TTL Logo.jfif" alt="Logo">
                </a>
            </div>
            <div class="library-name">
                <h2>THE TRAVELLER'S LIBRARY</h2>
            </div>
        </div>

        <ul class="menu">
            <li><a href="../../index.html" target="_blank">Home</a></li>
            <li><a href="../IML625 GP Website/About us.html" target="_blank">Profile</a></li>
            <li>
                <a>Services &#9662;</a>
                <ul class="dropdown">
                    <li><a href="http://10.145.112.43:8081" target="_blank">OPAC</a></li>
                    <li><a href="https://fliphtml5.com/bookcase/mrqbd/" target="_blank">E-Resources</a></li>
                    <li><a href="http://10.145.112.122" target="_blank">Institutional Repository</a></li>
                    <li><a href="../Useful Links/Useful Links.html">Useful Links</a></li>
                </ul>
            </li>
            <li><a href="../Contact Us/Contact Us.html" target="_blank">Contact Us</a></li>
        </ul>
    </nav>

<!-- ================= MAIN CONTENT ================= -->
<main class="page-content">
    <h1>Useful Links</h1>
    
    <div class="links-container">
        <!-- Link 1 -->
        <a href="https://www.booking.com/index.html?aid=2311236;label=en-my-booking-desktop-Z82anOs2zUfInrYP8brJFwS652828998631:pl:ta:p1:p2:ac:ap:neg:fi:tikwd-334108349:lp9072907:li:dec:dm;ws=&gad_source=1&gad_campaignid=19655506065&gbraid=0AAAAAD_Ls1INC0M4d94A5sNy2yfcXgQ8v&gclid=Cj0KCQiAvtzLBhCPARIsALwhxdpDpdu_eKQYq2l5HnKfIaf5EdrwsAm2Q8oPxPQrVp1uAJz35vVrZ54aAtddEALw_wcB&chal_t=1769484320660&force_referer=https%3A%2F%2Fwww.google.com%2F" target="_blank" class="link-card">
            <div class="link-logo">
                <img src="Useful Links Visuals/Booking.com.jfif" alt="Booking.com">
            </div>
            <div class="link-content">
                <h3>Booking.com</h3>
                <p>An online travel platform that allows users to search, compare, and book accommodations, flights, and travel services worldwide.</p>
            </div>
        </a>

        <!-- Link 2 -->
        <a href="https://www.klook.com/ms-MY/?campaignid=23319247905&adgroupid=189759011739&targetid=kwd-3063664836&matchtype=e&device=c&creative=786626763820&extensionid=&keyword=klook&loc_interest_ms=&loc_physical_ms=9072907&network=g&utm_content=campaignid_23319247905_adgroupid_189759011739&gad_source=1&gad_campaignid=23319247905&gbraid=0AAAAACa_CWwDBKQt0EPrmzpmsJkhKhnkb&gclid=Cj0KCQiAvtzLBhCPARIsALwhxdquzV4jVsDhR7Q3Ta8S2ENdia9Sij0bfQ5_kHKTeUhl1ItYZyauy1waAsffEALw_wcB" target="_blank" class="link-card">
            <div class="link-logo">
                <img src="Useful Links Visuals/Klook.jfif" alt="Klook">
            </div>
            <div class="link-content">
                <h3>Klook</h3>
                <p>A travel activities platform offering bookings for attractions, tours, transportation, and local experiences, especially popular in Asia.</p>
            </div>
        </a>

        <!-- Link 3 -->
        <a href="https://www.halal-navi.com/" target="_blank" class="link-card">
            <div class="link-logo">
                <img src="Useful Links Visuals/Halal Navi.jfif" alt="Halal Navi">
            </div>
            <div class="link-content">
                <h3>Halal Navi</h3>
                <p>A travel guide website that helps Muslim travelers find halal food, prayer spaces, and Muslim-friendly services around the world.</p>
            </div>
        </a>

        <!-- Link 4 -->
        <a href="https://www.oanda.com/currency-converter/en/?from=EUR&to=USD&amount=1" target="_blank" class="link-card">
            <div class="link-logo">
                <img src="Useful Links Visuals/OANDA.png" alt="OANDA">
            </div>
            <div class="link-content">
                <h3>OANDA</h3>
                <p>A free online tool that lets you check the latest foreign exchange rates and convert between world currencies using reliable, market-averaged data from OANDA Ratesâ„¢ â€” useful for budgeting travel expenses and comparing currency values before and during trips.</p>
            </div>
        </a>

        <!-- Link 5 -->
        <a href="https://theworldtravelguy.com/" target="_blank" class="link-card">
            <div class="link-logo">
                <img src="Useful Links Visuals/The World Travel Guy.png" alt="The World Travel Guide">
            </div>
            <div class="link-content">
                <h3>The World Travel Guy</h3>
                <p>A personal travel blog featuring destination guides, travel tips, photos, and stories from around the world to inspire and help beginners explore global travel.</p>
            </div>
        </a>
    </div>
</main>

<!-- ================= CHATBOT - HYBRID VERSION (FREE & RELIABLE) ================= -->
<!-- Place this code in any HTML page, right before closing </body> tag -->

<!-- CHATBOT STYLES -->
<style>
/* =========================
   CHATBOT (DRAGGABLE & RESIZABLE)
   ========================= */

/* Floating chat button */
.floating-icon {
    position: fixed;
    bottom: 30px;
    right: 30px;
    width: 60px;
    height: 60px;
    background-color: #86cfff;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: move;
    z-index: 999;
    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.25);
    transition: transform 0.3s ease;
    user-select: none;
}

.floating-icon:hover {
    transform: scale(1.08);
}

.floating-icon.dragging {
    cursor: grabbing;
    transform: scale(1.1);
}

/* Chat window */
.chat-card {
    position: fixed;
    bottom: 100px;
    right: 30px;
    width: 340px;
    height: 480px;
    min-width: 280px;
    min-height: 350px;
    max-width: 600px;
    max-height: 80vh;
    background-color: #fefcef;
    border-radius: 16px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.35);
    display: flex;
    flex-direction: column;
    overflow: hidden;
    opacity: 0;
    pointer-events: none;
    transform: translateY(20px);
    transition: opacity 0.3s ease, transform 0.3s ease;
    z-index: 1000;
    resize: both;
}

.chat-card.dragging {
    cursor: grabbing;
}

/* Active (opened) state */
.chat-card.active {
    opacity: 1;
    pointer-events: auto;
    transform: translateY(0);
}

/* Header */
.chat-card .header {
    background-color: #86cfff;
    padding: 12px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    cursor: move;
    user-select: none;
}

.chat-card .header:active {
    cursor: grabbing;
}

.header-content {
    display: flex;
    align-items: center;
    gap: 10px;
}

.avatar {
    width: 38px;
    height: 38px;
    background-color: #999ae8;
    color: white;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 20px;
}

.header-info h2 {
    font-size: 16px;
    margin: 0;
    color: #000435;
}

.header-info p {
    font-size: 12px;
    margin: 0;
    color: #000435;
}

.close-btn {
    background: none;
    border: none;
    font-size: 22px;
    cursor: pointer;
    color: #000435;
}

/* Chat body */
.chat-body {
    flex: 1;
    padding: 12px;
    overflow-y: auto;
    background-color: #f0e29a;
    display: flex;
    flex-direction: column;
    gap: 10px;
}

/* Messages */
.msg {
    max-width: 80%;
    padding: 10px 14px;
    border-radius: 14px;
    font-size: 14px;
    line-height: 1.4;
    word-wrap: break-word;
}

.msg.bot {
    background-color: #86cfff;
    align-self: flex-start;
}

.msg.user {
    background-color: #999ae8;
    color: white;
    align-self: flex-end;
}

/* Footer input */
.chat-card .footer {
    display: flex;
    padding: 10px;
    gap: 8px;
    background-color: #fefcef;
    border-top: 2px solid rgba(0, 4, 53, 0.2);
}

.chat-card input {
    flex: 1;
    padding: 8px 12px;
    border-radius: 20px;
    border: 2px solid #7e212a;
    outline: none;
}

.send-btn {
    background-color: #7e212a;
    color: white;
    border: none;
    border-radius: 20px;
    padding: 8px 14px;
    cursor: pointer;
    font-weight: bold;
}

/* Resize handle indicator */
.chat-card::after {
    content: 'â‹°';
    position: absolute;
    bottom: 2px;
    right: 2px;
    font-size: 16px;
    color: #999;
    pointer-events: none;
}

/* Mobile adjustments */
@media screen and (max-width: 500px) {
    .chat-card {
        width: calc(100% - 30px);
        right: 15px;
        bottom: 100px;
        max-height: 70vh;
    }

    .floating-icon {
        right: 15px;
        bottom: 30px;
    }
}
</style>

<!-- CHATBOT STYLES -->
<style>
/* Floating chat button */
.floating-icon {
    position: fixed;
    bottom: 80px;
    right: 30px;
    width: 60px;
    height: 60px;
    background-color: #86cfff;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: move;
    z-index: 999;
    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.25);
    transition: transform 0.3s ease;
    user-select: none;
    -webkit-tap-highlight-color: transparent;
    touch-action: none;
}

.floating-icon:hover {
    transform: scale(1.08);
}

.floating-icon.dragging {
    cursor: grabbing;
    transform: scale(1.1);
}

/* Chat window */
.chat-card {
    position: fixed;
    bottom: 150px;
    right: 30px;
    width: 340px;
    height: 480px;
    min-width: 280px;
    min-height: 350px;
    max-width: 600px;
    max-height: 80vh;
    background-color: #fefcef;
    border-radius: 16px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.35);
    display: flex;
    flex-direction: column;
    overflow: hidden;
    opacity: 0;
    pointer-events: none;
    transform: translateY(20px);
    transition: opacity 0.3s ease, transform 0.3s ease;
    z-index: 1000;
    resize: both;
}

.chat-card.dragging {
    cursor: grabbing;
}

.chat-card.active {
    opacity: 1;
    pointer-events: auto;
    transform: translateY(0);
}

.chat-card .header {
    background-color: #86cfff;
    padding: 12px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    cursor: move;
    user-select: none;
}

.chat-card .header:active {
    cursor: grabbing;
}

.header-content {
    display: flex;
    align-items: center;
    gap: 10px;
}

.avatar {
    width: 38px;
    height: 38px;
    background-color: #999ae8;
    color: white;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 20px;
}

.header-info h2 {
    font-size: 16px;
    margin: 0;
    color: #000435;
}

.header-info p {
    font-size: 12px;
    margin: 0;
    color: #000435;
}

.close-btn {
    background: none;
    border: none;
    font-size: 22px;
    cursor: pointer;
    color: #000435;
}

.chat-body {
    flex: 1;
    padding: 12px;
    overflow-y: auto;
    background-color: #f0e29a;
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.msg {
    max-width: 80%;
    padding: 10px 14px;
    border-radius: 14px;
    font-size: 14px;
    line-height: 1.4;
    word-wrap: break-word;
}

.msg.bot {
    background-color: #86cfff;
    align-self: flex-start;
}

.msg.user {
    background-color: #999ae8;
    color: white;
    align-self: flex-end;
}

.chat-card .footer {
    display: flex;
    padding: 10px;
    gap: 8px;
    background-color: #fefcef;
    border-top: 2px solid rgba(0, 4, 53, 0.2);
}

.chat-card input {
    flex: 1;
    padding: 8px 12px;
    border-radius: 20px;
    border: 2px solid #7e212a;
    outline: none;
}

.send-btn {
    background-color: #7e212a;
    color: white;
    border: none;
    border-radius: 20px;
    padding: 8px 14px;
    cursor: pointer;
    font-weight: bold;
}

.chat-card::after {
    content: 'â‹°';
    position: absolute;
    bottom: 2px;
    right: 2px;
    font-size: 16px;
    color: #999;
    pointer-events: none;
}

@media screen and (max-width: 500px) {
    .chat-card {
        width: calc(100% - 30px);
        right: 15px;
        bottom: 100px;
        max-height: 70vh;
    }
    .floating-icon {
        right: 15px;
        bottom: 30px;
    }
}
</style>

<!-- CHATBOT HTML -->
<div class="chat-card" id="chatWindow" aria-hidden="true">
    <div class="header" id="chatHeader">
        <div class="header-content">
            <div class="avatar">ðŸ¤–</div>
            <div class="header-info">
                <h2>Chat Support</h2>
                <p>Hi, I'm Sam. How can I help you?</p>
            </div>
        </div>
        <button class="close-btn" onclick="toggleChat()">Ã—</button>
    </div>

    <div class="chat-body" id="chatBody">
        <div class="msg bot">Hello! I'm Sam, your AI assistant for The Traveller's Library. I can help you with information about our services, collections, and resources. What would you like to know?</div>
    </div>

    <div class="footer">
        <input type="text" id="userInput" placeholder="Type a message..." autocomplete="off">
        <button class="send-btn" onclick="sendMessage()">Send</button>
    </div>
</div>

<!-- FLOATING CHAT ICON (NOTE: NO onclick attribute) -->
<div class="floating-icon" id="chatIcon" aria-label="Open chat">
    <svg width="35" height="35" viewBox="0 0 24 24" fill="white">
        <path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2z"/>
        <circle cx="8" cy="9" r="1.5" fill="#86CFFF"/>
        <circle cx="12" cy="9" r="1.5" fill="#86CFFF"/>
        <circle cx="16" cy="9" r="1.5" fill="#86CFFF"/>
    </svg>
</div>

<!-- CHATBOT JAVASCRIPT -->
<script>
/* CHATBOT FUNCTIONALITY */

const LIBRARY_CONTEXT = `You are Sam, a helpful AI assistant for The Traveller's Library.

ABOUT THE TRAVELLER'S LIBRARY:
The Traveller's Library is a specialized library in Malaysia focused on tourism, hospitality, and travel-related resources. Our mission is "Guiding Pathways to Tourism Knowledge." We serve students, researchers, and professionals in the tourism industry.

OUR SERVICES:
1. OPAC (Online Public Access Catalog) - http://10.145.112.43:8081
2. E-Resources - https://fliphtml5.com/bookcase/mrqbd/
3. Institutional Repository - http://10.125.129.122
4. Useful Links - Curated external tourism resources

CONTACT INFORMATION:
Email: searah2024@gmail.com
Facebook: https://www.facebook.com/share/181qiN9eAF/?mibextid=wwXIfr
Instagram: @travellers_library (https://www.instagram.com/travellers_library)

Always be concise, helpful, and include relevant URLs when directing users.`;

const KNOWLEDGE_BASE = {
    about: {
        keywords: ['what is', 'about', 'tell me about', 'describe', 'explain', 'who are you', 'library', 'mission', 'purpose'],
        responses: [
            "The Traveller's Library is a specialized library focused on tourism, hospitality, and travel resources in Malaysia. Our mission is 'Guiding Pathways to Tourism Knowledge.' We serve students, researchers, and tourism professionals.",
            "We're The Traveller's Library - your gateway to tourism knowledge! We specialize in tourism, hospitality, and travel information, offering physical books via OPAC, digital resources through E-Resources, and academic papers in our Institutional Repository."
        ]
    },
    services: {
        keywords: ['service', 'offer', 'provide', 'available', 'what can', 'features', 'facilities'],
        responses: [
            "We offer 4 main services: OPAC (http://10.145.112.43:8081), E-Resources (https://fliphtml5.com/bookcase/mrqbd/), Institutional Repository (http://10.125.129.122), and Useful Links.",
            "Our library provides comprehensive services: OPAC for searching our physical catalog, E-Resources for digital books available anytime, an Institutional Repository for academic research, and Useful Links for external tourism resources."
        ]
    },
    opac: {
        keywords: ['opac', 'book', 'catalog', 'catalogue', 'physical', 'borrow', 'search book'],
        responses: [
            "Search for books using our OPAC at http://10.145.112.43:8081. Browse physical books, journals, and tourism resources easily!",
            "Our OPAC (http://10.145.112.43:8081) lets you discover all physical books and materials on tourism, hospitality, and travel. Search by title, author, or subject."
        ]
    },
    eresources: {
        keywords: ['ebook', 'e-book', 'digital', 'online book', 'electronic', 'pdf', 'download'],
        responses: [
            "Access our E-Resources collection 24/7 at https://fliphtml5.com/bookcase/mrqbd/ with digital books on tourism and hospitality.",
            "Our digital library is available at https://fliphtml5.com/bookcase/mrqbd/ for e-books on tourism, hospitality, and travel."
        ]
    },
    repository: {
        keywords: ['repository', 'research', 'paper', 'thesis', 'dissertation', 'academic', 'publication'],
        responses: [
            "Visit our Institutional Repository at http://10.125.129.122 for research papers, theses, and dissertations focused on tourism.",
            "Our Institutional Repository (http://10.125.129.122) archives scholarly publications, research papers, and academic theses related to tourism and hospitality."
        ]
    },
    links: {
        keywords: ['useful link', 'external', 'website', 'other resource', 'link'],
        responses: [
            "Our Useful Links section provides curated external tourism resources including industry websites, databases, and research tools.",
            "We maintain a collection of Useful Links to external tourism resources - databases, industry websites, and government resources."
        ]
    },
    contact: {
        keywords: ['contact', 'email', 'reach', 'get in touch', 'message', 'facebook', 'instagram'],
        responses: [
            "Contact us: Email: searah2024@gmail.com | Facebook: https://www.facebook.com/share/181qiN9eAF | Instagram: @travellers_library",
            "Get in touch: Email: searah2024@gmail.com | Facebook: https://www.facebook.com/share/181qiN9eAF | Instagram: https://www.instagram.com/travellers_library"
        ]
    },
    greeting: {
        keywords: ['hello', 'hi', 'hey', 'good morning', 'good afternoon', 'good evening'],
        responses: [
            "Hello! ðŸ‘‹ I'm Sam, your assistant at The Traveller's Library. How can I help you today?",
            "Hi there! Welcome to The Traveller's Library! I'm Sam, your AI guide."
        ]
    },
    thanks: {
        keywords: ['thank', 'thanks', 'appreciate'],
        responses: [
            "You're welcome! ðŸ˜Š Let me know if you need more help with our resources.",
            "Glad to help! Enjoy exploring The Traveller's Library."
        ]
    },
    goodbye: {
        keywords: ['bye', 'goodbye', 'see you', 'later', 'take care'],
        responses: [
            "Goodbye! ðŸ‘‹ Come back anytime you need help with The Traveller's Library resources.",
            "Take care! Visit us again soon."
        ]
    }
};

function findFallbackResponse(userText) {
    const text = userText.toLowerCase();
    let bestMatch = null;
    let maxMatches = 0;

    for (const [category, data] of Object.entries(KNOWLEDGE_BASE)) {
        let matches = 0;
        for (const keyword of data.keywords) {
            if (text.includes(keyword)) matches++;
        }
        if (matches > maxMatches) {
            maxMatches = matches;
            bestMatch = category;
        }
    }

    if (bestMatch && maxMatches > 0) {
        const responses = KNOWLEDGE_BASE[bestMatch].responses;
        return responses[Math.floor(Math.random() * responses.length)];
    }
    return null;
}

async function getAIResponse(userText) {
    try {
        const prompt = `${LIBRARY_CONTEXT}\n\nUser question: ${userText}\n\nRespond as Sam in 2-4 sentences:`;
        const response = await fetch("https://api-inference.huggingface.co/models/microsoft/DialoGPT-large", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ inputs: prompt, parameters: { max_length: 200, temperature: 0.7, return_full_text: false } })
        });
        if (response.ok) {
            const data = await response.json();
            if (data && data[0] && data[0].generated_text) return data[0].generated_text.trim();
        }
    } catch (error) {
        console.log("AI service unavailable, using fallback:", error);
    }
    return null;
}

// ========== IMPROVED DRAGGABLE ICON WITH TOUCH SUPPORT ==========
let iconDragging = false;
let iconOffsetX = 0, iconOffsetY = 0, touchStartTime = 0;
let iconTouchMoved = false;
const floatingIcon = document.getElementById('chatIcon');

// Mouse events
floatingIcon.addEventListener('mousedown', function(e) {
    if (e.button === 2) return;
    iconDragging = true;
    floatingIcon.classList.add('dragging');
    iconOffsetX = e.clientX - floatingIcon.getBoundingClientRect().left;
    iconOffsetY = e.clientY - floatingIcon.getBoundingClientRect().top;
    e.preventDefault();
});

document.addEventListener('mousemove', function(e) {
    if (iconDragging) {
        const x = e.clientX - iconOffsetX;
        const y = e.clientY - iconOffsetY;
        floatingIcon.style.left = Math.max(0, Math.min(x, window.innerWidth - floatingIcon.offsetWidth)) + 'px';
        floatingIcon.style.top = Math.max(0, Math.min(y, window.innerHeight - floatingIcon.offsetHeight)) + 'px';
        floatingIcon.style.right = 'auto';
        floatingIcon.style.bottom = 'auto';
    }
});

document.addEventListener('mouseup', function() { 
    if (iconDragging) { 
        iconDragging = false; 
        floatingIcon.classList.remove('dragging'); 
    } 
});

floatingIcon.addEventListener('click', function(e) {
    if (!iconDragging) {
        toggleChat();
    }
});

// Touch events (IMPROVED)
floatingIcon.addEventListener('touchstart', function(e) {
    if (e.touches.length === 1) {
        const touch = e.touches[0];
        iconOffsetX = touch.clientX - floatingIcon.getBoundingClientRect().left;
        iconOffsetY = touch.clientY - floatingIcon.getBoundingClientRect().top;
        iconTouchMoved = false;
        touchStartTime = Date.now();
        e.preventDefault();
    }
}, { passive: false });

floatingIcon.addEventListener('touchmove', function(e) {
    if (e.touches.length === 1) {
        iconTouchMoved = true;
        const touch = e.touches[0];
        const x = touch.clientX - iconOffsetX;
        const y = touch.clientY - iconOffsetY;
        floatingIcon.style.left = Math.max(0, Math.min(x, window.innerWidth - floatingIcon.offsetWidth)) + 'px';
        floatingIcon.style.top = Math.max(0, Math.min(y, window.innerHeight - floatingIcon.offsetHeight)) + 'px';
        floatingIcon.style.right = 'auto';
        floatingIcon.style.bottom = 'auto';
        e.preventDefault();
    }
}, { passive: false });

floatingIcon.addEventListener('touchend', function(e) {
    const touchDuration = Date.now() - touchStartTime;
    if (!iconTouchMoved && touchDuration < 300) {
        toggleChat();
    }
    e.preventDefault();
}, { passive: false });

// ========== DRAGGABLE CHAT WINDOW ==========
let chatDragging = false, chatOffsetX = 0, chatOffsetY = 0;
const chatWindow = document.getElementById('chatWindow');
const chatHeader = document.getElementById('chatHeader');

chatHeader.addEventListener('mousedown', function(e) {
    if (e.target.classList.contains('close-btn')) return;
    chatDragging = true;
    chatWindow.classList.add('dragging');
    chatOffsetX = e.clientX - chatWindow.getBoundingClientRect().left;
    chatOffsetY = e.clientY - chatWindow.getBoundingClientRect().top;
    e.preventDefault();
});

document.addEventListener('mousemove', function(e) {
    if (chatDragging) {
        const x = e.clientX - chatOffsetX;
        const y = e.clientY - chatOffsetY;
        chatWindow.style.left = Math.max(0, Math.min(x, window.innerWidth - chatWindow.offsetWidth)) + 'px';
        chatWindow.style.top = Math.max(0, Math.min(y, window.innerHeight - chatWindow.offsetHeight)) + 'px';
        chatWindow.style.right = 'auto';
        chatWindow.style.bottom = 'auto';
    }
});

document.addEventListener('mouseup', function() { 
    if (chatDragging) { 
        chatDragging = false; 
        chatWindow.classList.remove('dragging'); 
    } 
});

chatHeader.addEventListener('touchstart', function(e) {
    if (e.target.classList.contains('close-btn')) return;
    if (e.touches.length === 1) {
        const touch = e.touches[0];
        chatDragging = true;
        chatOffsetX = touch.clientX - chatWindow.getBoundingClientRect().left;
        chatOffsetY = touch.clientY - chatWindow.getBoundingClientRect().top;
    }
});

chatHeader.addEventListener('touchmove', function(e) {
    if (chatDragging && e.touches.length === 1) {
        const touch = e.touches[0];
        const x = touch.clientX - chatOffsetX;
        const y = touch.clientY - chatOffsetY;
        chatWindow.style.left = Math.max(0, Math.min(x, window.innerWidth - chatWindow.offsetWidth)) + 'px';
        chatWindow.style.top = Math.max(0, Math.min(y, window.innerHeight - chatWindow.offsetHeight)) + 'px';
    }
});

chatHeader.addEventListener('touchend', function() { 
    chatDragging = false; 
});

// ========== CHAT FUNCTIONS ==========
function toggleChat() {
    const chatWindow = document.getElementById('chatWindow');
    chatWindow.classList.toggle('active');
    chatWindow.setAttribute('aria-hidden', !chatWindow.classList.contains('active'));
}

async function sendMessage() {
    const input = document.getElementById('userInput');
    const chatBody = document.getElementById('chatBody');
    const userText = input.value.trim();
    if (!userText) return;

    const userDiv = document.createElement('div');
    userDiv.className = 'msg user';
    userDiv.textContent = userText;
    chatBody.appendChild(userDiv);
    input.value = '';
    chatBody.scrollTop = chatBody.scrollHeight;

    const botDiv = document.createElement('div');
    botDiv.className = 'msg bot';
    botDiv.textContent = "Sam is typing...";
    chatBody.appendChild(botDiv);
    chatBody.scrollTop = chatBody.scrollHeight;

    const fallback = findFallbackResponse(userText);
    if (fallback) {
        setTimeout(() => { 
            botDiv.textContent = fallback; 
            chatBody.scrollTop = chatBody.scrollHeight; 
        }, 300);
    } else {
        const aiResp = await getAIResponse(userText);
        setTimeout(() => {
            botDiv.textContent = (aiResp && aiResp.length > 10) ? aiResp : 
                "I'm here to help with The Traveller's Library! Ask me about services, resources, or contact info.";
            chatBody.scrollTop = chatBody.scrollHeight;
        }, 500);
    }
}

document.addEventListener("DOMContentLoaded", () => {
    const input = document.getElementById("userInput");
    if (input) input.addEventListener("keypress", e => { if (e.key === "Enter") sendMessage(); });
});
</script>





<!-- ================= FOOTER ================= -->
<footer>
    <div class="footer-container">
        <div class="footer-left">
            Â© The Traveller's Library, 2026. This library portal is to complete a group project under IML625.
        </div>

<a href="https://www.freecounterstat.com" title="visitors counter"><img src="https://counter1.optistats.ovh/private/freecounterstat.php?c=5s3ct8llmes886ydn3b3tu4n39cdpfq2" 
                border="0" title="visitors counter" alt="visitors counter"></a>

        <div class="footer-right">
                <a href="https://www.facebook.com/share/181qiN9eAF/?mibextid=wwXIfr" target="_blank"><img src="../../Index Visuals/Footer/SocMed Logo/Facebook Logo.png" alt="Facebook" /></a>
                <a href="https://www.instagram.com/travellers_library?igsh=ajk1NGNwa2ZhZjgz&utm_source=qr" target="_blank"><img src="../../Index Visuals/Footer/SocMed Logo/Instagram Logo.jfif" alt="Instagram" /></a>
                <a href="mailto:searah2024@gmail.com"><img src="../../Index Visuals/Footer/SocMed Logo/Gmail.jfif" alt="Gmail" /></a>
                <a href="#"><img src="../../Index Visuals/Footer/Top Arrow.webp" id="footerimg" alt="Back to top" /></a>
            </div>
    </div>
</footer>



</body>
</html>
