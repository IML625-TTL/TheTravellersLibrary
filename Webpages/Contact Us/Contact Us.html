<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contact Us - The Traveller's Library</title>
    <link rel="stylesheet" href="Contact Us Styling.css"><link rel="icon" href="../../Favicon TTL (Y).ico" type="image/x-icon">
</head>
<body>

    <!-- NAVBAR -->
    <nav id="navbar">
        <div class="nav-left">
            <div class="logo">
                <a href="../../index.html" target="_blank">
                    <img src="../../Index Visuals/Navbar/TTL Logo.jfif" alt="Logo">
                </a>
            </div>
            <div class="library-name">
                <h2>THE TRAVELLER'S LIBRARY</h2>
            </div>
        </div>

        <ul class="menu">
            <li><a href="../../index.html" target="_blank">Home</a></li>
            <li><a href="../IML625 GP Website/About us.html" target="_blank">Profile</a></li>
            <li>
                <a>Services &#9662;</a>
                <ul class="dropdown">
                    <li><a href="http://10.125.129.43:8081" target="_blank">OPAC</a></li>
                    <li><a href="https://fliphtml5.com/bookcase/mrqbd/" target="_blank">E-Resources</a></li>
                    <li><a href="http://10.125.129.122" target="_blank">Institutional Repository</a></li>
                    <li><a href="../Useful Links/Useful Links.html" target="_blank">Useful Links</a></li>
                </ul>
            </li>
            <li><a href="../Contact Us/Contact Us.html">Contact Us</a></li>
        </ul>
    </nav>

    <!-- MAIN CONTENT SECTION -->
    <section id="contact" class="main-section">
        <h1 class="main-title">CONTACT US</h1>

        <div class="contact-container">
            <div class="contact-info">
                <h2 class="sub-heading">WE ARE HERE TO HELP :)</h2>
                <p class="description">
                    Please let us know how we can best serve you. You can use the contact form to email us or select from the topics below that best fit your needs. It's an honor to support you in your journey towards better knowledge.
                </p>
                
                <div class="contact-details">
                    <div class="detail-item">
                        <span class="icon">üìç</span>
                        <p>Universiti Teknologi MARA, UiTM Cawangan Negeri Sembilan Kampus, Jalan, Kampung Pilin, 71300 Rembau, Negeri Sembilan</p>
                    </div>
                    <div class="detail-item">
                        <span class="icon">‚úâÔ∏è</span>
                        <p>searah2024@gmail.com</p>
                    </div>
                    <div class="detail-item">
                        <span class="icon">üìû</span>
                        <p>+60123456789</p>
                    </div>
                </div>
            </div>

            <div class="contact-form">
                <form id="googleForm" action="https://docs.google.com/forms/d/e/1FAIpQLSetnsY4SaywDGp6OxmHf-BYksTP8O4ho4nUr3DwMKx2pEeOaQ/formResponse"
                method="POST">
                    <input type="text" name="entry.1829287987" placeholder="NAME" required>
                    <input type="email" name="entry.128281353" placeholder="EMAIL" required>
                    <input type="tel" name="entry.1858354903" placeholder="PHONE NUMBER" required>
                    <textarea placeholder="TYPE YOUR MESSAGE" name="entry.320568649" required></textarea>
                    
                    <button type="submit" class="send-btn">SEND MESSAGE</button>
                </form>
                

                <div class="security-notice">
                    <p>This site is protected by reCAPTCHA and the Google <a href="https://policies.google.com/privacy" target="_blank">Privacy Policy</a> and 
                        <a href="https://policies.google.com/terms" target="_blank">Terms of Service</a> apply.</p>
                </div>
            </div>
        </div>
    </section>

       <!-- ================= CHATBOT - HYBRID VERSION (FREE & RELIABLE) ================= -->
<!-- Place this code in any HTML page, right before closing </body> tag -->

<!-- CHATBOT STYLES -->
<style>
/* =========================
   CHATBOT (DRAGGABLE & RESIZABLE)
   ========================= */

/* Floating chat button */
.floating-icon {
    position: fixed;
    bottom: 30px;
    right: 30px;
    width: 60px;
    height: 60px;
    background-color: #86cfff;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: move;
    z-index: 999;
    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.25);
    transition: transform 0.3s ease;
    user-select: none;
}

.floating-icon:hover {
    transform: scale(1.08);
}

.floating-icon.dragging {
    cursor: grabbing;
    transform: scale(1.1);
}

/* Chat window */
.chat-card {
    position: fixed;
    bottom: 100px;
    right: 30px;
    width: 340px;
    height: 480px;
    min-width: 280px;
    min-height: 350px;
    max-width: 600px;
    max-height: 80vh;
    background-color: #fefcef;
    border-radius: 16px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.35);
    display: flex;
    flex-direction: column;
    overflow: hidden;
    opacity: 0;
    pointer-events: none;
    transform: translateY(20px);
    transition: opacity 0.3s ease, transform 0.3s ease;
    z-index: 1000;
    resize: both;
}

.chat-card.dragging {
    cursor: grabbing;
}

/* Active (opened) state */
.chat-card.active {
    opacity: 1;
    pointer-events: auto;
    transform: translateY(0);
}

/* Header */
.chat-card .header {
    background-color: #86cfff;
    padding: 12px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    cursor: move;
    user-select: none;
}

.chat-card .header:active {
    cursor: grabbing;
}

.header-content {
    display: flex;
    align-items: center;
    gap: 10px;
}

.avatar {
    width: 38px;
    height: 38px;
    background-color: #999ae8;
    color: white;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 20px;
}

.header-info h2 {
    font-size: 16px;
    margin: 0;
    color: #000435;
}

.header-info p {
    font-size: 12px;
    margin: 0;
    color: #000435;
}

.close-btn {
    background: none;
    border: none;
    font-size: 22px;
    cursor: pointer;
    color: #000435;
}

/* Chat body */
.chat-body {
    flex: 1;
    padding: 12px;
    overflow-y: auto;
    background-color: #f0e29a;
    display: flex;
    flex-direction: column;
    gap: 10px;
}

/* Messages */
.msg {
    max-width: 80%;
    padding: 10px 14px;
    border-radius: 14px;
    font-size: 14px;
    line-height: 1.4;
    word-wrap: break-word;
}

.msg.bot {
    background-color: #86cfff;
    align-self: flex-start;
}

.msg.user {
    background-color: #999ae8;
    color: white;
    align-self: flex-end;
}

/* Footer input */
.chat-card .footer {
    display: flex;
    padding: 10px;
    gap: 8px;
    background-color: #fefcef;
    border-top: 2px solid rgba(0, 4, 53, 0.2);
}

.chat-card input {
    flex: 1;
    padding: 8px 12px;
    border-radius: 20px;
    border: 2px solid #7e212a;
    outline: none;
}

.send-btn {
    background-color: #7e212a;
    color: white;
    border: none;
    border-radius: 20px;
    padding: 8px 14px;
    cursor: pointer;
    font-weight: bold;
}

/* Resize handle indicator */
.chat-card::after {
    content: '‚ã∞';
    position: absolute;
    bottom: 2px;
    right: 2px;
    font-size: 16px;
    color: #999;
    pointer-events: none;
}

/* Mobile adjustments */
@media screen and (max-width: 500px) {
    .chat-card {
        width: calc(100% - 30px);
        right: 15px;
        bottom: 100px;
        max-height: 70vh;
    }

    .floating-icon {
        right: 15px;
        bottom: 30px;
    }
}
</style>

<!-- CHATBOT HTML -->
<div class="chat-card" id="chatWindow" aria-hidden="true">
    <div class="header" id="chatHeader">
        <div class="header-content">
            <div class="avatar">ü§ñ</div>
            <div class="header-info">
                <h2>Chat Support</h2>
                <p>Hi, I'm Sam. How can I help you?</p>
            </div>
        </div>
        <button class="close-btn" onclick="toggleChat()">√ó</button>
    </div>

    <div class="chat-body" id="chatBody">
        <div class="msg bot">Hello! I'm Sam, your AI assistant for The Traveller's Library. I can help you with information about our services, collections, and resources. What would you like to know?</div>
    </div>

    <div class="footer">
        <input type="text" id="userInput" placeholder="Type a message..." autocomplete="off">
        <button class="send-btn" onclick="sendMessage()">Send</button>
    </div>
</div>

<!-- FLOATING CHAT ICON -->
<div class="floating-icon" id="chatIcon" onclick="toggleChat()" aria-label="Open chat">
    <svg width="35" height="35" viewBox="0 0 24 24" fill="white">
        <path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2z"/>
        <circle cx="8" cy="9" r="1.5" fill="#86CFFF"/>
        <circle cx="12" cy="9" r="1.5" fill="#86CFFF"/>
        <circle cx="16" cy="9" r="1.5" fill="#86CFFF"/>
    </svg>
</div>

<!-- CHATBOT SCRIPT -->
<script>
/* ==========================
   CHATBOT FUNCTIONALITY
   ========================== */

// Library context - comprehensive knowledge base
const LIBRARY_CONTEXT = `You are Sam, a helpful AI assistant for The Traveller's Library.

ABOUT THE TRAVELLER'S LIBRARY:
The Traveller's Library is a specialized library in Malaysia focused on tourism, hospitality, and travel-related resources. Our mission is "Guiding Pathways to Tourism Knowledge." We serve students, researchers, and professionals in the tourism industry.

OUR SERVICES:

1. OPAC (Online Public Access Catalog)
   URL: http://10.125.129.43:8081
   - Search our physical book collection
   - Koha-based library management system
   - Browse books, journals, and materials
   - Find tourism and hospitality resources

2. E-Resources
   URL: https://fliphtml5.com/bookcase/mrqbd/
   - Digital collection of electronic books
   - Tourism and hospitality e-books
   - Available 24/7 online
   - Accessible from anywhere

3. Institutional Repository
   URL: http://10.125.129.122
   - Archive of academic works and research
   - Theses and dissertations
   - Research papers on tourism
   - Scholarly publications

4. Useful Links
   - Curated external tourism resources
   - Industry websites and databases
   - Tourism organizations
   - Research tools and references

CONTACT INFORMATION:
Email: searah2024@gmail.com
Facebook: https://www.facebook.com/share/181qiN9eAF/?mibextid=wwXIfr
Instagram: @travellers_library (https://www.instagram.com/travellers_library)

TEAM & ABOUT US:
This is a group project under IML625 course. The library portal was created to provide comprehensive tourism knowledge and resources to the academic community and tourism professionals.

COLLECTIONS:
- Tourism management books and journals
- Hospitality industry resources
- Travel and destination marketing materials
- Sustainable tourism publications
- Tourism research papers and theses
- Digital tourism resources

HOW TO HELP USERS:
- Answer questions about library services
- Direct users to appropriate resources (OPAC, E-Resources, Repository)
- Explain how to search for materials
- Provide tourism-related information
- Share contact details when needed
- Be friendly, professional, and helpful

When users ask about:
- Books/physical materials ‚Üí Direct to OPAC
- E-books/digital resources ‚Üí Direct to E-Resources
- Research papers/theses ‚Üí Direct to Institutional Repository
- External resources ‚Üí Mention Useful Links
- Contact/help ‚Üí Provide email and social media

Always be concise (2-4 sentences), helpful, and include relevant URLs when directing to services.`;

// Comprehensive fallback knowledge base
const KNOWLEDGE_BASE = {
    about: {
        keywords: ['what is', 'about', 'tell me about', 'describe', 'explain', 'who are you', 'library', 'mission', 'purpose'],
        responses: [
            "The Traveller's Library is a specialized library focused on tourism, hospitality, and travel resources in Malaysia. Our mission is 'Guiding Pathways to Tourism Knowledge.' We serve students, researchers, and tourism professionals with comprehensive resources including books, e-books, and research papers.",
            "We're The Traveller's Library - your gateway to tourism knowledge! We specialize in tourism, hospitality, and travel information, offering physical books via OPAC, digital resources through E-Resources, and academic papers in our Institutional Repository. This is a group project under IML625."
        ]
    },
    
    services: {
        keywords: ['service', 'offer', 'provide', 'available', 'what can', 'what do you', 'features', 'facilities', 'main service'],
        responses: [
            "We offer 4 main services:\n\n1Ô∏è‚É£ OPAC (http://10.125.129.43:8081) - Search physical books\n2Ô∏è‚É£ E-Resources (https://fliphtml5.com/bookcase/mrqbd/) - Access digital books 24/7\n3Ô∏è‚É£ Institutional Repository (http://10.125.129.122) - Browse research papers\n4Ô∏è‚É£ Useful Links - Explore curated tourism resources\n\nWhich interests you?",
            "Our library provides comprehensive services: OPAC for searching our physical catalog, E-Resources for digital books available anytime, an Institutional Repository for academic research, and Useful Links for external tourism resources. All focused on tourism and hospitality! What would you like to explore?"
        ]
    },
    
    opac: {
        keywords: ['opac', 'book', 'catalog', 'catalogue', 'physical', 'borrow', 'search book', 'find book', 'koha', 'library catalog', 'printed book'],
        responses: [
            "Search for books using our OPAC at http://10.125.129.43:8081 üìö\n\nOur Koha-based system lets you browse our entire collection of physical materials including books, journals, and tourism resources. You can search by title, author, subject, or keyword!",
            "Our OPAC (Online Public Access Catalog) is at http://10.125.129.43:8081. It's your gateway to discovering all our physical books and materials on tourism, hospitality, and travel. The system is easy to use - just search for what you need!"
        ]
    },
    
    eresources: {
        keywords: ['ebook', 'e-book', 'e-resource', 'digital', 'online book', 'electronic', 'pdf', 'download', 'virtual', 'digital book', 'online resource'],
        responses: [
            "Access our E-Resources collection 24/7 at https://fliphtml5.com/bookcase/mrqbd/ üíª\n\nWe have digital books on tourism and hospitality that you can access anytime, anywhere - perfect for online research and study!",
            "Our digital library is available at https://fliphtml5.com/bookcase/mrqbd/ with e-books on tourism, hospitality, and travel. These resources are accessible around the clock, so you can study whenever it suits you!"
        ]
    },
    
    repository: {
        keywords: ['repository', 'research', 'paper', 'thesis', 'dissertation', 'academic', 'publication', 'journal', 'scholarly', 'study', 'research paper'],
        responses: [
            "Visit our Institutional Repository at http://10.125.129.122 üìÑ\n\nIt contains academic works including research papers, theses, and dissertations focused on tourism. Excellent for researchers and students working on tourism projects!",
            "Our Institutional Repository (http://10.125.129.122) archives scholarly publications, research papers, and academic theses related to tourism and hospitality. It's a valuable collection for serious research work!"
        ]
    },
    
    links: {
        keywords: ['useful link', 'external', 'website', 'other resource', 'link', 'outside', 'web', 'external resource', 'other site'],
        responses: [
            "Our Useful Links section provides curated external resources including tourism organizations, databases, industry websites, and research tools. These carefully selected links complement our collections with additional tourism knowledge sources.",
            "We maintain a collection of Useful Links to external tourism resources - databases, industry websites, tourism organizations, and government resources. These enhance your research with additional specialized sources!"
        ]
    },
    
    tourism: {
        keywords: ['tourism', 'travel', 'hospitality', 'hotel', 'destination', 'tourist', 'vacation', 'industry', 'tourism industry'],
        responses: [
            "As a tourism-focused library, we specialize in tourism management, hospitality, travel industry, destination marketing, sustainable tourism, and more. Our collections support research across all aspects of tourism - accessible via OPAC, E-Resources, and our Repository!",
            "We're dedicated to tourism resources! Whether you're studying tourism management, researching travel trends, exploring hospitality operations, or investigating sustainable tourism, we have materials across all our services to support your work."
        ]
    },
    
    contact: {
        keywords: ['contact', 'email', 'reach', 'get in touch', 'message', 'phone', 'address', 'location', 'facebook', 'instagram', 'social media', 'how to contact'],
        responses: [
            "Contact us:\nüìß Email: searah2024@gmail.com\nüìò Facebook: https://www.facebook.com/share/181qiN9eAF/\nüì∑ Instagram: @travellers_library\n\nFeel free to reach out with any questions!",
            "Get in touch:\n‚Ä¢ Email: searah2024@gmail.com\n‚Ä¢ Facebook: https://www.facebook.com/share/181qiN9eAF/?mibextid=wwXIfr\n‚Ä¢ Instagram: https://www.instagram.com/travellers_library\n\nWe're here to help!"
        ]
    },
    
    help: {
        keywords: ['how to', 'how do i', 'help', 'guide', 'tutorial', 'instruction', 'use', 'access', 'start', 'begin', 'need help'],
        responses: [
            "Here's how to use our services:\nüìö Books ‚Üí OPAC: http://10.125.129.43:8081\nüíª E-books ‚Üí E-Resources: https://fliphtml5.com/bookcase/mrqbd/\nüìÑ Research ‚Üí Repository: http://10.125.129.122\nüîó External ‚Üí Useful Links section\n\nWhat would you like to explore?",
            "I can guide you! Looking for:\n‚Ä¢ Physical books? ‚Üí Use OPAC\n‚Ä¢ Digital resources? ‚Üí Try E-Resources\n‚Ä¢ Academic papers? ‚Üí Visit our Repository\n‚Ä¢ External sites? ‚Üí Check Useful Links\n\nWhat interests you?"
        ]
    },
    
    hours: {
        keywords: ['hour', 'open', 'close', 'time', 'when', 'available', 'access time', 'operating', 'opening hour', 'schedule'],
        responses: [
            "Our digital services (E-Resources at https://fliphtml5.com/bookcase/mrqbd/ and Institutional Repository at http://10.125.129.122) are available 24/7! For physical library hours and OPAC access times, please contact us at searah2024@gmail.com.",
            "E-Resources and our Repository are accessible 24/7 online! For information about physical library operating hours, reach out to searah2024@gmail.com or check our Facebook page."
        ]
    },
    
    collection: {
        keywords: ['collection', 'material', 'have', 'find', 'looking for', 'resource', 'database', 'what do you have'],
        responses: [
            "Our collection includes tourism books, hospitality journals, travel guides, research papers, e-books, and academic publications. Search via:\n‚Ä¢ OPAC for physical items\n‚Ä¢ E-Resources for digital materials\n‚Ä¢ Repository for academic works\n\nWhat topic are you researching?",
            "We have extensive tourism and hospitality collections: books, journals, e-books, research papers, and theses. These are accessible through OPAC (http://10.125.129.43:8081), E-Resources (https://fliphtml5.com/bookcase/mrqbd/), and our Repository. What subject interests you?"
        ]
    },
    
    search: {
        keywords: ['search', 'find', 'look for', 'looking', 'where can i find', 'how to find', 'locate'],
        responses: [
            "To search our resources:\n1. Physical books ‚Üí OPAC: http://10.125.129.43:8081\n2. Digital books ‚Üí E-Resources: https://fliphtml5.com/bookcase/mrqbd/\n3. Research papers ‚Üí Repository: http://10.125.129.122\n\nWhat type of material are you looking for?",
            "You can search different ways:\n‚Ä¢ OPAC for physical books and materials\n‚Ä¢ E-Resources for digital/online books\n‚Ä¢ Institutional Repository for academic research\n\nTell me what you need and I'll point you in the right direction!"
        ]
    },
    
    team: {
        keywords: ['team', 'staff', 'who made', 'developer', 'creator', 'built', 'iml625', 'group project', 'student'],
        responses: [
            "The Traveller's Library is a group project under the IML625 course. It was developed by a team of students to provide comprehensive tourism knowledge resources to the academic community. For more details, visit our About Us page or contact us at searah2024@gmail.com!",
            "This library portal is a collaborative group project for the IML625 course! Our team worked to create this specialized tourism resource center. You can learn more by visiting our About Us page or reaching out at searah2024@gmail.com."
        ]
    },
    
    greeting: {
        keywords: ['hello', 'hi', 'hey', 'good morning', 'good afternoon', 'good evening', 'greetings', 'hola', 'howdy'],
        responses: [
            "Hello! üëã I'm Sam, your assistant at The Traveller's Library. I can help you find books, e-resources, research papers, and answer questions about our tourism collections. What can I help you with today?",
            "Hi there! Welcome to The Traveller's Library! I'm Sam, and I can guide you through our OPAC, E-Resources, Institutional Repository, and more. How may I assist you?",
            "Hey! I'm Sam from The Traveller's Library. Whether you need books, e-books, research papers, or just have questions about our tourism resources, I'm here to help! What would you like to know?"
        ]
    },
    
    thanks: {
        keywords: ['thank', 'thanks', 'appreciate', 'helpful', 'great', 'awesome', 'good job', 'perfect'],
        responses: [
            "You're very welcome! üòä If you need anything else about our library services or tourism resources, feel free to ask. Happy researching!",
            "My pleasure! Don't hesitate to ask if you have more questions about The Traveller's Library. Enjoy exploring our resources!",
            "Glad I could help! Come back anytime you need assistance with books, e-resources, or research. Good luck with your tourism studies! üìö"
        ]
    },
    
    goodbye: {
        keywords: ['bye', 'goodbye', 'see you', 'later', 'take care', 'gotta go', 'leave'],
        responses: [
            "Goodbye! üëã Come back anytime you need help with The Traveller's Library resources. Happy travels in your research journey!",
            "Take care! Feel free to return whenever you need assistance. Good luck with your tourism research!",
            "See you later! Remember, we're here 24/7 for digital resources. Visit us again soon! üåç"
        ]
    }
};

// Find best matching response from knowledge base
function findFallbackResponse(userText) {
    const text = userText.toLowerCase();
    let bestMatch = null;
    let maxMatches = 0;
    
    for (const [category, data] of Object.entries(KNOWLEDGE_BASE)) {
        let matches = 0;
        for (const keyword of data.keywords) {
            if (text.includes(keyword)) {
                matches++;
            }
        }
        
        if (matches > maxMatches) {
            maxMatches = matches;
            bestMatch = category;
        }
    }
    
    if (bestMatch && maxMatches > 0) {
        const responses = KNOWLEDGE_BASE[bestMatch].responses;
        return responses[Math.floor(Math.random() * responses.length)];
    }
    
    return null;
}

// Try AI response with Hugging Face (free, no API key needed for some models)
async function getAIResponse(userText) {
    try {
        const prompt = `${LIBRARY_CONTEXT}\n\nUser question: ${userText}\n\nRespond as Sam in 2-4 sentences. Be helpful and include relevant URLs when directing to services:`;
        
        // Using free Hugging Face Inference API
        const response = await fetch(
            "https://api-inference.huggingface.co/models/microsoft/DialoGPT-large",
            {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify({
                    inputs: prompt,
                    parameters: {
                        max_length: 200,
                        temperature: 0.7,
                        return_full_text: false
                    }
                })
            }
        );

        if (response.ok) {
            const data = await response.json();
            if (data && data[0] && data[0].generated_text) {
                return data[0].generated_text.trim();
            }
        }
    } catch (error) {
        console.log("AI service unavailable, using fallback:", error);
    }
    
    return null;
}

// Draggable functionality for floating icon
let isDraggingIcon = false;
let iconOffsetX = 0;
let iconOffsetY = 0;

const floatingIcon = document.getElementById('chatIcon');

floatingIcon.addEventListener('mousedown', function(e) {
    if (e.button === 2) return;
    isDraggingIcon = true;
    floatingIcon.classList.add('dragging');
    iconOffsetX = e.clientX - floatingIcon.getBoundingClientRect().left;
    iconOffsetY = e.clientY - floatingIcon.getBoundingClientRect().top;
    e.preventDefault();
});

document.addEventListener('mousemove', function(e) {
    if (isDraggingIcon) {
        const x = e.clientX - iconOffsetX;
        const y = e.clientY - iconOffsetY;
        
        const maxX = window.innerWidth - floatingIcon.offsetWidth;
        const maxY = window.innerHeight - floatingIcon.offsetHeight;
        
        floatingIcon.style.left = Math.max(0, Math.min(x, maxX)) + 'px';
        floatingIcon.style.top = Math.max(0, Math.min(y, maxY)) + 'px';
        floatingIcon.style.right = 'auto';
        floatingIcon.style.bottom = 'auto';
    }
});

document.addEventListener('mouseup', function() {
    if (isDraggingIcon) {
        isDraggingIcon = false;
        floatingIcon.classList.remove('dragging');
    }
});

// Draggable functionality for chat window
let isDraggingChat = false;
let chatOffsetX = 0;
let chatOffsetY = 0;

const chatWindow = document.getElementById('chatWindow');
const chatHeader = document.getElementById('chatHeader');

chatHeader.addEventListener('mousedown', function(e) {
    if (e.target.classList.contains('close-btn')) return;
    isDraggingChat = true;
    chatWindow.classList.add('dragging');
    chatOffsetX = e.clientX - chatWindow.getBoundingClientRect().left;
    chatOffsetY = e.clientY - chatWindow.getBoundingClientRect().top;
    e.preventDefault();
});

document.addEventListener('mousemove', function(e) {
    if (isDraggingChat) {
        const x = e.clientX - chatOffsetX;
        const y = e.clientY - chatOffsetY;
        
        const maxX = window.innerWidth - chatWindow.offsetWidth;
        const maxY = window.innerHeight - chatWindow.offsetHeight;
        
        chatWindow.style.left = Math.max(0, Math.min(x, maxX)) + 'px';
        chatWindow.style.top = Math.max(0, Math.min(y, maxY)) + 'px';
        chatWindow.style.right = 'auto';
        chatWindow.style.bottom = 'auto';
    }
});

document.addEventListener('mouseup', function() {
    if (isDraggingChat) {
        isDraggingChat = false;
        chatWindow.classList.remove('dragging');
    }
});

// Chat toggle
function toggleChat() {
    if (isDraggingIcon) return;
    const chatWindow = document.getElementById('chatWindow');
    chatWindow.classList.toggle('active');
    chatWindow.setAttribute(
        'aria-hidden',
        !chatWindow.classList.contains('active')
    );
}

// Send message - hybrid approach
async function sendMessage() {
    const input = document.getElementById('userInput');
    const chatBody = document.getElementById('chatBody');
    const userText = input.value.trim();

    if (userText === "") return;

    // User bubble
    const userDiv = document.createElement('div');
    userDiv.className = 'msg user';
    userDiv.textContent = userText;
    chatBody.appendChild(userDiv);

    input.value = "";
    chatBody.scrollTop = chatBody.scrollHeight;

    // Typing indicator
    const botDiv = document.createElement('div');
    botDiv.className = 'msg bot';
    botDiv.textContent = "Sam is typing...";
    chatBody.appendChild(botDiv);
    chatBody.scrollTop = chatBody.scrollHeight;

    // First, check for instant fallback response
    const fallbackResponse = findFallbackResponse(userText);
    
    if (fallbackResponse) {
        // Use fallback immediately for known questions
        setTimeout(() => {
            botDiv.textContent = fallbackResponse;
            chatBody.scrollTop = chatBody.scrollHeight;
        }, 300);
    } else {
        // Try AI for unknown questions, fallback if it fails
        const aiResponse = await getAIResponse(userText);
        
        setTimeout(() => {
            if (aiResponse && aiResponse.length > 10) {
                botDiv.textContent = aiResponse;
            } else {
                // Ultimate fallback
                botDiv.textContent = "I'm here to help with The Traveller's Library! You can ask me about:\n‚Ä¢ Our services (OPAC, E-Resources, Repository)\n‚Ä¢ How to find books or e-books\n‚Ä¢ Research papers and resources\n‚Ä¢ Tourism collections\n‚Ä¢ Contact information\n\nWhat would you like to know?";
            }
            chatBody.scrollTop = chatBody.scrollHeight;
        }, 500);
    }
}

// Enter key support
document.addEventListener("DOMContentLoaded", () => {
    const input = document.getElementById("userInput");
    if (input) {
        input.addEventListener("keypress", (e) => {
            if (e.key === "Enter") sendMessage();
        });
    }
});

// Touch support for mobile
floatingIcon.addEventListener('touchstart', function(e) {
    isDraggingIcon = true;
    floatingIcon.classList.add('dragging');
    const touch = e.touches[0];
    iconOffsetX = touch.clientX - floatingIcon.getBoundingClientRect().left;
    iconOffsetY = touch.clientY - floatingIcon.getBoundingClientRect().top;
    e.preventDefault();
});

document.addEventListener('touchmove', function(e) {
    if (isDraggingIcon) {
        const touch = e.touches[0];
        const x = touch.clientX - iconOffsetX;
        const y = touch.clientY - iconOffsetY;
        
        const maxX = window.innerWidth - floatingIcon.offsetWidth;
        const maxY = window.innerHeight - floatingIcon.offsetHeight;
        
        floatingIcon.style.left = Math.max(0, Math.min(x, maxX)) + 'px';
        floatingIcon.style.top = Math.max(0, Math.min(y, maxY)) + 'px';
        floatingIcon.style.right = 'auto';
        floatingIcon.style.bottom = 'auto';
    }
});

document.addEventListener('touchend', function() {
    if (isDraggingIcon) {
        isDraggingIcon = false;
        floatingIcon.classList.remove('dragging');
    }
});

chatHeader.addEventListener('touchstart', function(e) {
    if (e.target.classList.contains('close-btn')) return;
    isDraggingChat = true;
    chatWindow.classList.add('dragging');
    const touch = e.touches[0];
    chatOffsetX = touch.clientX - chatWindow.getBoundingClientRect().left;
    chatOffsetY = touch.clientY - chatWindow.getBoundingClientRect().top;
    e.preventDefault();
});

document.addEventListener('touchmove', function(e) {
    if (isDraggingChat) {
        const touch = e.touches[0];
        const x = touch.clientX - chatOffsetX;
        const y = touch.clientY - chatOffsetY;
        
        const maxX = window.innerWidth - chatWindow.offsetWidth;
        const maxY = window.innerHeight - chatWindow.offsetHeight;
        
        chatWindow.style.left = Math.max(0, Math.min(x, maxX)) + 'px';
        chatWindow.style.top = Math.max(0, Math.min(y, maxY)) + 'px';
        chatWindow.style.right = 'auto';
        chatWindow.style.bottom = 'auto';
    }
});

document.addEventListener('touchend', function() {
    if (isDraggingChat) {
        isDraggingChat = false;
        chatWindow.classList.remove('dragging');
    }
});
</script>

   
    <!-- FOOTER -->
    <footer>
        <div class="footer-container">
            <div class="footer-left">
                ¬© The Traveller's Library, 2026. This library portal is to complete a group project under IML625.
            </div>

<a href="https://www.freecounterstat.com" title="visitors counter"><img src="https://counter1.optistats.ovh/private/freecounterstat.php?c=5s3ct8llmes886ydn3b3tu4n39cdpfq2" 
                border="0" title="visitors counter" alt="visitors counter"></a>

            <div class="footer-right">
                <a href="https://www.facebook.com/share/181qiN9eAF/?mibextid=wwXIfr" target="_blank"><img src="../../Index Visuals/Footer/SocMed Logo/Facebook Logo.png" alt="Facebook" /></a>
                <a href="https://www.instagram.com/travellers_library?igsh=ajk1NGNwa2ZhZjgz&utm_source=qr" target="_blank"><img src="../../Index Visuals/Footer/SocMed Logo/Instagram Logo.jfif" alt="Instagram" /></a>
                <a href="searah2024@gmail.com"><img src="../../Index Visuals/Footer/SocMed Logo/Gmail.jfif" alt="Gmail" /></a>
                <a href="#navbar"><img src="../../Index Visuals/Footer/Top Arrow.webp" id="footerimg" alt="Back to top" /></a>
            </div>
        </div>
    </footer>

    <script>
        // Intersection Observer for main section fade animation
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px'
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting && entry.target.classList.contains('main-section')) {
                    entry.target.classList.add('animate-in');
                }
            });
        }, observerOptions);

        // Observe main section
        document.querySelector('.main-section').addEventListener('DOMContentLoaded', observer.observe(document.querySelector('.main-section')));
        
        // Trigger animation on page load
        window.addEventListener('load', () => {
            document.querySelector('.main-section').classList.add('animate-in');
        });
    </script>
    <script>
document.getElementById('googleForm').addEventListener('submit', function(e){
    e.preventDefault(); // Prevent default form submission
    const form = e.target;
    fetch(form.action, {
        method: 'POST',
        body: new FormData(form),
        mode: 'no-cors' // Google Forms only allows no-cors submissions
    }).then(() => {
        alert('Your message has been sent successfully!');
        form.reset();
    }).catch(() => {
        alert('There was an error sending your message.');
    });
});
</script>



</body>
</html>