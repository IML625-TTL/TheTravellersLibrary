<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Traveller's Library - Guiding Pathways to Tourism Knowledge</title>
    <link rel="stylesheet" href="index.css"><link rel="icon" href="Favicon TTL (Y).ico" type="image/x-icon">
    
</head>

<body>

    <!-- NAVBAR -->
<nav id="navbar">
    <div class="nav-left">
        <div class="logo">
            <a href="index.html">
                <img src="Index Visuals/Navbar/TTL Logo.jfif" alt="Logo">
            </a>
        </div>
        <div class="library-name">
            <h2>THE TRAVELLER'S LIBRARY</h2>
        </div>
    </div>

    <ul class="menu">
        <li><a href="index.html">Home</a></li>
        <li><a href="Webpages/IML625 GP Website/About us.html" target="_blank">Profile</a></li>
        <li class="services-dropdown">
            <a href="#">Services &#9662;</a>
            <ul class="dropdown">
                <li><a href="http://10.145.112.43:8081" target="_blank">OPAC</a></li>
                <li><a href="https://fliphtml5.com/bookcase/mrqbd/" target="_blank">E-Resources</a></li>
                <li><a href="http://10.145.112.122" target="_blank">Institutional Repository</a></li>
                <li><a href="Webpages/Useful Links/Useful Links.html" target="_blank">Useful Links</a></li>
            </ul>
        </li>
        <li><a href="Webpages/Contact Us/Contact Us.html" target="_blank">Contact Us</a></li>
    </ul>
</nav>


    <!-- SECTION 1 : HERO -->
    <section class="section hero" id="section1">
        <div class="hero-content">
            <svg viewBox="0 0 500 240" width="100%" height="100%">

                <!-- Main curve -->
                <path id="curve-main" d="M10,140 Q250,50 490,140" fill="transparent"></path>

                <!-- Sub curve -->
                <path id="curve-sub" d="M30,160 Q250,90 470,160" fill="transparent"></path>

                <!-- Main text with white stroke -->
                <text font-family="Arial" font-size="20" stroke="white" stroke-width="6" fill="none" font-weight="bold">
                    <textPath href="#curve-main" startOffset="50%" text-anchor="middle">
                        WELCOME TO THE TRAVELLER'S LIBRARY
                    </textPath>
                </text>
                <text font-family="Arial" font-size="20" fill="black" font-weight="bold">
                    <textPath href="#curve-main" startOffset="50%" text-anchor="middle">
                        WELCOME TO THE TRAVELLER'S LIBRARY
                    </textPath>
                </text>

                <!-- Sub text with white stroke -->
                <text font-family="Arial" font-size="18" stroke="white" stroke-width="5" fill="none" font-weight="bold">
                    <textPath href="#curve-sub" startOffset="50%" text-anchor="middle">
                        "Guiding Pathways to Tourism Knowledge"
                    </textPath>
                </text>
                <text font-family="Arial" font-size="18" fill="black" font-weight="bold">
                    <textPath href="#curve-sub" startOffset="50%" text-anchor="middle">
                        "Guiding Pathways to Tourism Knowledge"
                    </textPath>
                </text>

                <!-- Functional Search bar (simplified) -->
                <foreignObject x="110" y="180" width="315" height="30">
                    <div xmlns="http://www.w3.org/1999/xhtml" class="search-bar-container">
                        <input type="text" id="searchInput" placeholder="Search in OPAC..." />
                        <button type="button" id="dropdownBtn" onclick="toggleSearchDropdown()">
                            <span id="selectedService">OPAC</span>
                            <span class="arrow">‚ñº</span>
                        </button>
                        <button type="button" class="search-btn" onclick="performSearch()">
                            <svg width="15" height="15" viewBox="0 0 15 15">
                                <circle cx="6" cy="6" r="4" stroke="#555" stroke-width="1.5" fill="none"></circle>
                                <line x1="8.5" y1="8.5" x2="12" y2="12" stroke="#555" stroke-width="1.5"></line>
                            </svg>
                        </button>
                    </div>
                </foreignObject>

            </svg>
        </div>
        
        <!-- Search Dropdown Menu (outside SVG for proper positioning) -->
        <div id="searchDropdown" class="search-dropdown-menu">
            <div class="dropdown-item" onclick="selectService('OPAC', 'http://10.145.112.43:8081')">OPAC</div>
            <div class="dropdown-item" onclick="selectService('E-Res.', 'https://fliphtml5.com/bookcase/mrqbd/')">E-Resources</div>
            <div class="dropdown-item" onclick="selectService('Inst. Rep.', 'http://10.145.112.122')">Institutional Repository</div>
        </div>
    </section>

    <!-- SECTION 2 & 3 COMBINED -->
    <section class="section combined-section" id="section2-3">
        
        <!-- LEFT SIDE: SERVICES (2/5) -->
        <div class="services-container">
            <h2 class="section-title" id="h2s3">Our Services</h2>

            <div class="services-grid">

                <div class="service-box">
                    <a href="http://10.145.112.43:8081" target="_blank">
                        <img src="Index Visuals/Section 3/Services Logo/Koha Logo.png" id="opac" alt="OPAC" />
                    </a>
                    <span class="service-title">OPAC</span>
                    <p class="service-desc">Search library materials</p>
                </div>

                <div class="service-box">
                    <a href="https://fliphtml5.com/bookcase/mrqbd/" target="_blank">
                        <img src="Index Visuals/Section 3/Services Logo/E-Resources Logo.png" id="er" alt="E-Resources" />
                    </a>
                    <span class="service-title">E-Resources</span>
                    <p class="service-desc">Digital books collection</p>
                </div>

                <div class="service-box">
                    <a href="http://10.145.112.122" target="_blank">
                        <img src="Index Visuals/Section 3/Services Logo/Institutional Repository Logo.png" id="ir" alt="Institutional Repository" />
                    </a>
                    <span class="service-title">Institutional Repository</span>
                    <p class="service-desc">Academic works archive</p>
                </div>

                <div class="service-box">
                    <a href="Webpages/Useful Links/Useful Links.html" target="_blank">
                        <img src="Index Visuals/Section 3/Services Logo/Useful Links.png" alt="Useful Links" id="ul">
                    </a>
                    <span class="service-title">Useful Links</span>
                    <p class="service-desc">External resources</p>
                </div>

            </div>
        </div>

        <!-- RIGHT SIDE: NEWS (3/5) -->
        <div class="news-container">
            <h2 id="h2s2">News</h2>
            
            <div class="slideshow-container">

                <div class="mySlides">
                    <a href="https://www.untourism.int/news/international-tourist-arrivals-up-4-in-2025-reflecting-strong-travel-demand-around-the-world" 
                    target="_blank"><img src="Index Visuals/Section 2/Slides/S1 - UN Tourism News.png" alt="International tourist arrivals up 4% in 2025 reflecting strong travel demand around the world - UN Tourism"
                    title="International tourist arrivals up 4% in 2025 reflecting strong travel demand around the world - UN Tourism" /></a>
                </div>

                <div class="mySlides">
                    <a href="https://www.tourism-review.com/southeast-asias-tourism-is-mostly-recovered-news15145" target="_blank">
                    <img src="Index Visuals/Section 2/Slides/S2 - Tourism Review News.png" alt="Southeast Asia'S Tourism Industry Renaissance - Tourism Review" title="Southeast Asia'S Tourism Industry Renaissance - Tourism Review" /></a>
                </div>

                <div class="mySlides">
                    <a href="https://www.malaymail.com/news/malaysia/2025/12/18/stats-dept-malaysias-domestic-tourism-hits-216-million-visitors-rm884b-spending/202427"
                    target="_blank"><img src="Index Visuals/Section 2/Slides/S3 - Malay Mail News.png" alt="Stats Dept: Malaysia's domestic tourism hits 216 million visitors, RM88.4b spending - Malay Mail" title="Stats Dept: Malaysia's domestic tourism hits 216 million visitors, RM88.4b spending - Malay Mail" /></a>
                </div>

                <div class="mySlides">
                    <a href="https://www.thestar.com.my/news/nation/2026/01/24/restoring-trust-in-tourism-industry"
                    target="_blank"><img src="Index Visuals/Section 2/Slides/S4 - The Star A1.png" alt="Restoring Trust in tourism industry - The Star" title="Restoring Trust in tourism industry - The Star" /></a>
                </div>
                
                <div class="mySlides">
                    <a href="https://www.thestar.com.my/news/nation/2025/11/13/expanding-tourism-focus-beyond-asean"
                    target="_blank"><img src="Index Visuals/Section 2/Slides/S5 - The Star A2.png" alt="Expanding tourism focus beyond Asean - The Star" title="Expanding tourism focus beyond Asean - The Star" /></a>
                </div>

                <div class="mySlides">
                    <a href="https://www.thestar.com.my/news/nation/2025/11/14/khazanah-invested-over-rm4bil-in-tourism-sites"
                    target="_blank"><img src="Index Visuals/Section 2/Slides/S6 - The Star A3.png" alt="Khazanah invested over RM4bil in tourism sites - The Star" title="Khazanah invested over RM4bil in tourism sites - The Star" /></a>
                </div>

                <div class="mySlides">
                    <a href="https://www.thestar.com.my/lifestyle/travel/2025/02/19/tourism-selangor-forges-strategic-partnerships-to-boost-vsy-2025"
                    target="_blank"><img src="Index Visuals/Section 2/Slides/S7 - The Star A4.png" alt="Tourism Selangor forges strategic partnerships to boost VSY 2025 - The Star" title="Tourism Selangor forges strategic partnerships to boost VSY 2025 - The Star" /></a>
                </div>

                <div class="mySlides">
                    <a href="https://www.bharian.com.my/bisnes/lain-lain/2025/03/1369286/malaysia-pasaran-pelancongan-keempat-paling-lestari-di-asia"
                    target="_blank"><img src="Index Visuals/Section 2/Slides/S8 - BH A1.png" alt="Malaysia pasaran pelancongan keempat paling lestari di Asia - Berita Harian" title="Malaysia pasaran pelancongan keempat paling lestari di Asia - Berita Harian" /></a>
                </div>

                <div class="mySlides">
                    <a href="https://www.bharian.com.my/berita/nasional/2025/09/1451193/malaysia-komited-bangunkan-industri-pelancongan-bertaraf-dunia-pm"
                    target="_blank"><img src="Index Visuals/Section 2/Slides/S9 - BH A2.png" alt="Malaysia komited bangunkan industri pelancongan bertaraf dunia - PM - Berita Harian" title="Malaysia komited bangunkan industri pelancongan bertaraf dunia - PM - Berita Harian" /></a>
                </div>

                <div class="mySlides">
                    <a href="https://www.sinarharian.com.my/article/740944/berita/nasional/malaysia-nombor-satu-dalam-pelancongan-mesra-muslim"
                    target="_blank"><img src="Index Visuals/Section 2/Slides/S10 - Sinar Harian News.png" alt="Malaysia nombor satu dalam Pelancongan Mesra Muslim - Sinar Harian" title="Malaysia nombor satu dalam Pelancongan Mesra Muslim - Berita Harian" /></a>
                </div>

                <div class="mySlides">
                    <a href="https://www.utusan.com.my/terkini/2021/12/langkawi-catat-pendapatan-rm487-juta/"
                    target="_blank"><img src="Index Visuals/Section 2/Slides/S11 - Utusan Malaysia News.png" alt="Langkawi catat pendapatan RM487 juta - Utusan Malaysia" title="Langkawi catat pendapatan RM487 juta - Utusan Malaysia" /></a>
                </div>

                <div class="mySlides">
                    <a href="https://www.tourism.gov.my/media/view/tourism-malaysia-dan-aeon-bekerjasama-dalam-kolaborasi-strategik-promosi-tahun-melawat-malaysia-2026"
                    target="_blank"><img src="Index Visuals/Section 2/Slides/S12 - Tourism Malaysia A1.png" alt="Tourism Malaysia dan AEON Bekerjasama dalam Kolaborasi Strategik Promosi Tahun Melawat Malaysia 2026 - Tourism Malaysia" 
                    title="Tourism Malaysia dan AEON Bekerjasama dalam Kolaborasi Strategik Promosi Tahun Melawat Malaysia 2026 - Tourism Malaysia" /></a>
                </div>

                <div class="mySlides">
                    <a href="https://www.tourism.gov.my/media/view/juneyao-air-launches-inaugural-flight-from-shanghai-to-tawau"
                    target="_blank"><img src="Index Visuals/Section 2/Slides/S13 - Tourism Malaysia A2.png" alt="Juneyao Air Launches Inaugural Flight from Shanghai to Tawau - Tourism Malaysia" 
                    title="Tourism Malaysia dan AEON Bekerjasama dalam Kolaborasi Strategik Promosi Tahun Melawat Malaysia 2026 - Tourism Malaysia" /></a>
                </div>

                <a class="prev" onclick="plusSlides(-1)">&#10094;</a>
                <a class="next" onclick="plusSlides(1)">&#10095;</a>

            </div>
        </div>

    </section>



   <!-- ================= CHATBOT - HYBRID VERSION (FREE & RELIABLE) ================= -->
<!-- Place this code in any HTML page, right before closing </body> tag -->

<!-- CHATBOT STYLES -->
<style>
/* =========================
   CHATBOT (DRAGGABLE & RESIZABLE)
   ========================= */

/* Floating chat button */
.floating-icon {
    position: fixed;
    bottom: 80px;
    right: 30px;
    width: 60px;
    height: 60px;
    background-color: #86cfff;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: move;
    z-index: 999;
    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.25);
    transition: transform 0.3s ease;
    user-select: none;
    /* ADDED FOR TOUCH SUPPORT */
    -webkit-tap-highlight-color: transparent;
    touch-action: none;
}

.floating-icon:hover {
    transform: scale(1.08);
}

.floating-icon.dragging {
    cursor: grabbing;
    transform: scale(1.1);
}

/* Chat window */
.chat-card {
    position: fixed;
    bottom: 150px;
    right: 30px;
    width: 340px;
    height: 480px;
    min-width: 280px;
    min-height: 350px;
    max-width: 600px;
    max-height: 80vh;
    background-color: #fefcef;
    border-radius: 16px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.35);
    display: flex;
    flex-direction: column;
    overflow: hidden;
    opacity: 0;
    pointer-events: none;
    transform: translateY(20px);
    transition: opacity 0.3s ease, transform 0.3s ease;
    z-index: 1000;
    resize: both;
}

.chat-card.dragging {
    cursor: grabbing;
}

/* Active (opened) state */
.chat-card.active {
    opacity: 1;
    pointer-events: auto;
    transform: translateY(0);
}

/* Header */
.chat-card .header {
    background-color: #86cfff;
    padding: 12px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    cursor: move;
    user-select: none;
}

.chat-card .header:active {
    cursor: grabbing;
}

.header-content {
    display: flex;
    align-items: center;
    gap: 10px;
}

.avatar {
    width: 38px;
    height: 38px;
    background-color: #999ae8;
    color: white;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 20px;
}

.header-info h2 {
    font-size: 16px;
    margin: 0;
    color: #000435;
}

.header-info p {
    font-size: 12px;
    margin: 0;
    color: #000435;
}

.close-btn {
    background: none;
    border: none;
    font-size: 22px;
    cursor: pointer;
    color: #000435;
}

/* Chat body */
.chat-body {
    flex: 1;
    padding: 12px;
    overflow-y: auto;
    background-color: #f0e29a;
    display: flex;
    flex-direction: column;
    gap: 10px;
}

/* Messages */
.msg {
    max-width: 80%;
    padding: 10px 14px;
    border-radius: 14px;
    font-size: 14px;
    line-height: 1.4;
    word-wrap: break-word;
}

.msg.bot {
    background-color: #86cfff;
    align-self: flex-start;
}

.msg.user {
    background-color: #999ae8;
    color: white;
    align-self: flex-end;
}

/* Footer input */
.chat-card .footer {
    display: flex;
    padding: 10px;
    gap: 8px;
    background-color: #fefcef;
    border-top: 2px solid rgba(0, 4, 53, 0.2);
}

.chat-card input {
    flex: 1;
    padding: 8px 12px;
    border-radius: 20px;
    border: 2px solid #7e212a;
    outline: none;
}

.send-btn {
    background-color: #7e212a;
    color: white;
    border: none;
    border-radius: 20px;
    padding: 8px 14px;
    cursor: pointer;
    font-weight: bold;
}

/* Resize handle indicator */
.chat-card::after {
    content: '‚ã∞';
    position: absolute;
    bottom: 2px;
    right: 2px;
    font-size: 16px;
    color: #999;
    pointer-events: none;
}

/* Mobile adjustments */
@media screen and (max-width: 500px) {
    .chat-card {
        width: calc(100% - 30px);
        right: 15px;
        bottom: 100px;
        max-height: 70vh;
    }

    .floating-icon {
        right: 15px;
        bottom: 30px;
    }
}
</style>

<!-- CHATBOT HTML -->
<div class="chat-card" id="chatWindow" aria-hidden="true">
    <div class="header" id="chatHeader">
        <div class="header-content">
            <div class="avatar">ü§ñ</div>
            <div class="header-info">
                <h2>Chat Support</h2>
                <p>Hi, I'm Sam. How can I help you?</p>
            </div>
        </div>
        <button class="close-btn" onclick="toggleChat()">√ó</button>
    </div>

    <div class="chat-body" id="chatBody">
        <div class="msg bot">Hello! I'm Sam, your AI assistant for The Traveller's Library. I can help you with information about our services, collections, and resources. What would you like to know?</div>
    </div>

    <div class="footer">
        <input type="text" id="userInput" placeholder="Type a message..." autocomplete="off">
        <button class="send-btn" onclick="sendMessage()">Send</button>
    </div>
</div>

<!-- FLOATING CHAT ICON -->
<!-- REMOVED onclick from here - now handled by touch/click events in JavaScript -->
<div class="floating-icon" id="chatIcon" aria-label="Open chat">
    <svg width="35" height="35" viewBox="0 0 24 24" fill="white">
        <path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2z"/>
        <circle cx="8" cy="9" r="1.5" fill="#86CFFF"/>
        <circle cx="12" cy="9" r="1.5" fill="#86CFFF"/>
        <circle cx="16" cy="9" r="1.5" fill="#86CFFF"/>
    </svg>
</div>

<!-- CHATBOT SCRIPT -->
<script>
/* =========================
   CHATBOT FUNCTIONALITY
   ========================= */

// Library context - comprehensive knowledge base
const LIBRARY_CONTEXT = `You are Sam, a helpful AI assistant for The Traveller's Library.

ABOUT THE TRAVELLER'S LIBRARY:
The Traveller's Library is a specialized library in Malaysia focused on tourism, hospitality, and travel-related resources. Our mission is "Guiding Pathways to Tourism Knowledge." We serve students, researchers, and professionals in the tourism industry.

OUR SERVICES:
1. OPAC (Online Public Access Catalog) - http://10.145.112.43:8081
2. E-Resources - https://fliphtml5.com/bookcase/mrqbd/
3. Institutional Repository - http://10.145.112.122
4. Useful Links - Curated external tourism resources

CONTACT INFORMATION:
Email: searah2024@gmail.com
Facebook: https://www.facebook.com/share/181qiN9eAF/?mibextid=wwXIfr
Instagram: @travellers_library (https://www.instagram.com/travellers_library)

Always be concise, helpful, and include relevant URLs when directing users.`;

// Knowledge base for fallback responses
const KNOWLEDGE_BASE = {
    about: {
        keywords: ['what is', 'about', 'tell me about', 'describe', 'explain', 'who are you', 'library', 'mission', 'purpose'],
        responses: [
            "The Traveller's Library is a specialized library focused on tourism, hospitality, and travel resources in Malaysia. Our mission is 'Guiding Pathways to Tourism Knowledge.' We serve students, researchers, and tourism professionals.",
            "We're The Traveller's Library - your gateway to tourism knowledge! We specialize in tourism, hospitality, and travel information, offering physical books via OPAC, digital resources through E-Resources, and academic papers in our Institutional Repository."
        ]
    },
    services: {
        keywords: ['service', 'offer', 'provide', 'available', 'what can', 'features', 'facilities'],
        responses: [
            "We offer 4 main services: OPAC (http://10.145.112.43:8081), E-Resources (https://fliphtml5.com/bookcase/mrqbd/), Institutional Repository (http://10.145.112.122), and Useful Links.",
            "Our library provides comprehensive services: OPAC for searching our physical catalog, E-Resources for digital books available anytime, an Institutional Repository for academic research, and Useful Links for external tourism resources."
        ]
    },
    opac: {
        keywords: ['opac', 'book', 'catalog', 'catalogue', 'physical', 'borrow', 'search book'],
        responses: [
            "Search for books using our OPAC at http://10.145.112.43:8081. Browse physical books, journals, and tourism resources easily!",
            "Our OPAC (http://10.145.112.43:8081) lets you discover all physical books and materials on tourism, hospitality, and travel. Search by title, author, or subject."
        ]
    },
    eresources: {
        keywords: ['ebook', 'e-book', 'digital', 'online book', 'electronic', 'pdf', 'download'],
        responses: [
            "Access our E-Resources collection 24/7 at https://fliphtml5.com/bookcase/mrqbd/ with digital books on tourism and hospitality.",
            "Our digital library is available at https://fliphtml5.com/bookcase/mrqbd/ for e-books on tourism, hospitality, and travel."
        ]
    },
    repository: {
        keywords: ['repository', 'research', 'paper', 'thesis', 'dissertation', 'academic', 'publication'],
        responses: [
            "Visit our Institutional Repository at http://10.145.112.122 for research papers, theses, and dissertations focused on tourism.",
            "Our Institutional Repository (http://10.145.112.122) archives scholarly publications, research papers, and academic theses related to tourism and hospitality."
        ]
    },
    links: {
        keywords: ['useful link', 'external', 'website', 'other resource', 'link'],
        responses: [
            "Our Useful Links section provides curated external tourism resources including industry websites, databases, and research tools.",
            "We maintain a collection of Useful Links to external tourism resources - databases, industry websites, and government resources."
        ]
    },
    contact: {
        keywords: ['contact', 'email', 'reach', 'get in touch', 'message', 'facebook', 'instagram'],
        responses: [
            "Contact us: Email: searah2024@gmail.com | Facebook: https://www.facebook.com/share/181qiN9eAF | Instagram: @travellers_library",
            "Get in touch: Email: searah2024@gmail.com | Facebook: https://www.facebook.com/share/181qiN9eAF | Instagram: https://www.instagram.com/travellers_library"
        ]
    },
    greeting: {
        keywords: ['hello', 'hi', 'hey', 'good morning', 'good afternoon', 'good evening'],
        responses: [
            "Hello! üëã I'm Sam, your assistant at The Traveller's Library. How can I help you today?",
            "Hi there! Welcome to The Traveller's Library! I'm Sam, your AI guide."
        ]
    },
    thanks: {
        keywords: ['thank', 'thanks', 'appreciate'],
        responses: [
            "You're welcome! üòä Let me know if you need more help with our resources.",
            "Glad to help! Enjoy exploring The Traveller's Library."
        ]
    },
    goodbye: {
        keywords: ['bye', 'goodbye', 'see you', 'later', 'take care'],
        responses: [
            "Goodbye! üëã Come back anytime you need help with The Traveller's Library resources.",
            "Take care! Visit us again soon."
        ]
    }
};

// Find fallback response
function findFallbackResponse(userText) {
    const text = userText.toLowerCase();
    let bestMatch = null;
    let maxMatches = 0;

    for (const [category, data] of Object.entries(KNOWLEDGE_BASE)) {
        let matches = 0;
        for (const keyword of data.keywords) {
            if (text.includes(keyword)) matches++;
        }
        if (matches > maxMatches) {
            maxMatches = matches;
            bestMatch = category;
        }
    }

    if (bestMatch && maxMatches > 0) {
        const responses = KNOWLEDGE_BASE[bestMatch].responses;
        return responses[Math.floor(Math.random() * responses.length)];
    }
    return null;
}

// AI response via Hugging Face (fallback if needed)
async function getAIResponse(userText) {
    try {
        const prompt = `${LIBRARY_CONTEXT}\n\nUser question: ${userText}\n\nRespond as Sam in 2-4 sentences:`;
        const response = await fetch("https://api-inference.huggingface.co/models/microsoft/DialoGPT-large", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ inputs: prompt, parameters: { max_length: 200, temperature: 0.7, return_full_text: false } })
        });
        if (response.ok) {
            const data = await response.json();
            if (data && data[0] && data[0].generated_text) return data[0].generated_text.trim();
        }
    } catch (error) {
        console.log("AI service unavailable, using fallback:", error);
    }
    return null;
}

// ================= DRAGGABLE FLOATING ICON (IMPROVED TOUCH SUPPORT) =================
let iconDragging = false;
let iconOffsetX = 0, iconOffsetY = 0, touchStartTime = 0;
let iconTouchMoved = false; // Track if touch moved
const floatingIcon = document.getElementById('chatIcon');

// Mouse drag for desktop
floatingIcon.addEventListener('mousedown', function(e) {
    if (e.button === 2) return; // Ignore right-click
    iconDragging = true;
    floatingIcon.classList.add('dragging');
    iconOffsetX = e.clientX - floatingIcon.getBoundingClientRect().left;
    iconOffsetY = e.clientY - floatingIcon.getBoundingClientRect().top;
    e.preventDefault();
});

document.addEventListener('mousemove', function(e) {
    if (iconDragging) {
        const x = e.clientX - iconOffsetX;
        const y = e.clientY - iconOffsetY;
        floatingIcon.style.left = Math.max(0, Math.min(x, window.innerWidth - floatingIcon.offsetWidth)) + 'px';
        floatingIcon.style.top = Math.max(0, Math.min(y, window.innerHeight - floatingIcon.offsetHeight)) + 'px';
        floatingIcon.style.right = 'auto';
        floatingIcon.style.bottom = 'auto';
    }
});

document.addEventListener('mouseup', function() { 
    if (iconDragging) { 
        iconDragging = false; 
        floatingIcon.classList.remove('dragging'); 
    } 
});

// Mouse click to toggle chat (only if not dragging)
floatingIcon.addEventListener('click', function(e) {
    if (!iconDragging) {
        toggleChat();
    }
});

// ===== IMPROVED TOUCH SUPPORT =====
floatingIcon.addEventListener('touchstart', function(e) {
    if (e.touches.length === 1) {
        const touch = e.touches[0];
        iconOffsetX = touch.clientX - floatingIcon.getBoundingClientRect().left;
        iconOffsetY = touch.clientY - floatingIcon.getBoundingClientRect().top;
        iconTouchMoved = false; // Reset movement tracking
        touchStartTime = Date.now();
        e.preventDefault(); // Prevent default touch behavior
    }
}, { passive: false });

floatingIcon.addEventListener('touchmove', function(e) {
    if (e.touches.length === 1) {
        iconTouchMoved = true; // Mark that touch moved
        const touch = e.touches[0];
        const x = touch.clientX - iconOffsetX;
        const y = touch.clientY - iconOffsetY;
        floatingIcon.style.left = Math.max(0, Math.min(x, window.innerWidth - floatingIcon.offsetWidth)) + 'px';
        floatingIcon.style.top = Math.max(0, Math.min(y, window.innerHeight - floatingIcon.offsetHeight)) + 'px';
        floatingIcon.style.right = 'auto';
        floatingIcon.style.bottom = 'auto';
        e.preventDefault(); // Prevent scrolling while dragging
    }
}, { passive: false });

floatingIcon.addEventListener('touchend', function(e) {
    const touchDuration = Date.now() - touchStartTime;
    // Only toggle chat if it was a quick tap (< 300ms) and didn't move
    if (!iconTouchMoved && touchDuration < 300) {
        toggleChat();
    }
    e.preventDefault();
}, { passive: false });

// ================= DRAGGABLE CHAT WINDOW =================
let chatDragging = false, chatOffsetX = 0, chatOffsetY = 0;
const chatWindow = document.getElementById('chatWindow');
const chatHeader = document.getElementById('chatHeader');

chatHeader.addEventListener('mousedown', function(e) {
    if (e.target.classList.contains('close-btn')) return;
    chatDragging = true;
    chatWindow.classList.add('dragging');
    chatOffsetX = e.clientX - chatWindow.getBoundingClientRect().left;
    chatOffsetY = e.clientY - chatWindow.getBoundingClientRect().top;
    e.preventDefault();
});
document.addEventListener('mousemove', function(e) {
    if (chatDragging) {
        const x = e.clientX - chatOffsetX;
        const y = e.clientY - chatOffsetY;
        chatWindow.style.left = Math.max(0, Math.min(x, window.innerWidth - chatWindow.offsetWidth)) + 'px';
        chatWindow.style.top = Math.max(0, Math.min(y, window.innerHeight - chatWindow.offsetHeight)) + 'px';
        chatWindow.style.right = 'auto';
        chatWindow.style.bottom = 'auto';
    }
});
document.addEventListener('mouseup', function() { if (chatDragging) { chatDragging = false; chatWindow.classList.remove('dragging'); } });

// Touch drag for chat window
chatHeader.addEventListener('touchstart', function(e) {
    if (e.target.classList.contains('close-btn')) return;
    if (e.touches.length === 1) {
        const touch = e.touches[0];
        chatDragging = true;
        chatOffsetX = touch.clientX - chatWindow.getBoundingClientRect().left;
        chatOffsetY = touch.clientY - chatWindow.getBoundingClientRect().top;
    }
});
chatHeader.addEventListener('touchmove', function(e) {
    if (chatDragging && e.touches.length === 1) {
        const touch = e.touches[0];
        const x = touch.clientX - chatOffsetX;
        const y = touch.clientY - chatOffsetY;
        chatWindow.style.left = Math.max(0, Math.min(x, window.innerWidth - chatWindow.offsetWidth)) + 'px';
        chatWindow.style.top = Math.max(0, Math.min(y, window.innerHeight - chatWindow.offsetHeight)) + 'px';
    }
});
chatHeader.addEventListener('touchend', function() { chatDragging = false; });

// ================= CHAT TOGGLE =================
function toggleChat() {
    const chatWindow = document.getElementById('chatWindow');
    chatWindow.classList.toggle('active');
    chatWindow.setAttribute('aria-hidden', !chatWindow.classList.contains('active'));
}

// ================= SEND MESSAGE =================
async function sendMessage() {
    const input = document.getElementById('userInput');
    const chatBody = document.getElementById('chatBody');
    const userText = input.value.trim();
    if (!userText) return;

    // User bubble
    const userDiv = document.createElement('div');
    userDiv.className = 'msg user';
    userDiv.textContent = userText;
    chatBody.appendChild(userDiv);
    input.value = '';
    chatBody.scrollTop = chatBody.scrollHeight;

    // Bot typing
    const botDiv = document.createElement('div');
    botDiv.className = 'msg bot';
    botDiv.textContent = "Sam is typing...";
    chatBody.appendChild(botDiv);
    chatBody.scrollTop = chatBody.scrollHeight;

    const fallback = findFallbackResponse(userText);
    if (fallback) {
        setTimeout(() => { botDiv.textContent = fallback; chatBody.scrollTop = chatBody.scrollHeight; }, 300);
    } else {
        const aiResp = await getAIResponse(userText);
        setTimeout(() => {
            botDiv.textContent = (aiResp && aiResp.length > 10) ? aiResp : 
                "I'm here to help with The Traveller's Library! Ask me about services, resources, or contact info.";
            chatBody.scrollTop = chatBody.scrollHeight;
        }, 500);
    }
}

// ================= ENTER KEY SUPPORT =================
document.addEventListener("DOMContentLoaded", () => {
    const input = document.getElementById("userInput");
    if (input) input.addEventListener("keypress", e => { if (e.key === "Enter") sendMessage(); });
});

</script>



    
    <!-- FOOTER -->
    <footer>
        <div class="footer-container">

            <div class="footer-left">
                ¬© The Traveller's Library, 2026. This library portal is to complete a group project under IML625.
            </div>

            <a href="https://www.freecounterstat.com" title="visitors counter"><img src="https://counter1.optistats.ovh/private/freecounterstat.php?c=5s3ct8llmes886ydn3b3tu4n39cdpfq2" 
                border="0" title="visitors counter" alt="visitors counter"></a>

            <div class="footer-right">
                <a href="https://www.facebook.com/share/181qiN9eAF/?mibextid=wwXIfr" target="_blank"><img src="Index Visuals/Footer/SocMed Logo/Facebook Logo.png" alt="Facebook" /></a>
                <a href="https://www.instagram.com/travellers_library?igsh=ajk1NGNwa2ZhZjgz&utm_source=qr" target="_blank"><img src="Index Visuals/Footer/SocMed Logo/Instagram Logo.jfif" alt="Instagram" /></a>
                <a href="mailto:searah2024@gmail.com"><img src="Index Visuals/Footer/SocMed Logo/Gmail.jfif" alt="Gmail" /></a>
                <a href="#"><img src="Index Visuals/Footer/Top Arrow.webp" id="footerimg" alt="Back to top" /></a>
            </div>

        </div>
    </footer>

<script>
/* =========================
   üîç SEARCH BAR FUNCTIONALITY
   ========================= */

// Store the currently selected service URL and name
let selectedServiceUrl = 'http://10.145.112.43:8081'; // Default to OPAC
let selectedServiceName = 'OPAC'; // Default service name

// Toggle the dropdown menu visibility
function toggleSearchDropdown() {
    const dropdown = document.getElementById('searchDropdown');
    dropdown.classList.toggle('show');
}

// Select a service from the dropdown
function selectService(name, url) {
    // Update the button text to show selected service
    document.getElementById('selectedService').textContent = name;
    
    // Store the selected service URL and name
    selectedServiceUrl = url;
    selectedServiceName = name;
    
    // Close the dropdown
    document.getElementById('searchDropdown').classList.remove('show');
    
    // Update placeholder to match selected service
    const searchInput = document.getElementById('searchInput');
    searchInput.placeholder = `Search in ${name}...`;
}

// Close dropdown when clicking outside
document.addEventListener('click', function(event) {
    const dropdown = document.getElementById('searchDropdown');
    const dropdownBtn = document.getElementById('dropdownBtn');
    
    if (dropdown && dropdownBtn && 
        !dropdown.contains(event.target) && 
        !dropdownBtn.contains(event.target)) {
        dropdown.classList.remove('show');
    }
});

// ===== üéØ MAIN SEARCH FUNCTION - THIS IS WHERE THE MAGIC HAPPENS =====
function performSearch() {
    const searchInput = document.getElementById('searchInput').value.trim();
    
    // If search input is empty, just open the service homepage
    if (!searchInput) {
        window.open(selectedServiceUrl, '_blank');
        return;
    }
    
    // Build search URL based on selected service
    let searchUrl = '';
    
    // üìå OPAC (Koha) - Search in library catalog
    if (selectedServiceName === 'OPAC') {
        // Koha search format: /cgi-bin/koha/opac-search.pl?q=SEARCH_QUERY
        searchUrl = `${selectedServiceUrl}/cgi-bin/koha/opac-search.pl?q=${encodeURIComponent(searchInput)}`;
    }
    
    // üìå E-Resources (FlipHTML5) - Just open the main page (no direct search available)
    else if (selectedServiceName === 'E-Res.') {
        // FlipHTML5 doesn't support URL-based search, so open main page
        searchUrl = selectedServiceUrl;
        alert(`Opening E-Resources. Please use the search function on the page to find "${searchInput}"`);
    }
    
    // üìå Institutional Repository - Search in repository
    else if (selectedServiceName === 'Inst. Rep.') {
        // DSpace search format: /simple-search?query=SEARCH_QUERY
        searchUrl = `${selectedServiceUrl}/simple-search?query=${encodeURIComponent(searchInput)}`;
    }
    
    // Open the constructed search URL in a new tab
    if (searchUrl) {
        window.open(searchUrl, '_blank');
    } else {
        alert('Please select a service to search');
    }
}

// ===== ENTER KEY SUPPORT - Trigger search when user presses Enter =====
document.addEventListener('DOMContentLoaded', function() {
    const searchInput = document.getElementById('searchInput');
    if (searchInput) {
        searchInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                performSearch();
            }
        });
    }
}); 
</script>

<script>

// Slideshow functionality
let slideIndex = 1;
let slideDirection = 1;
let isAnimating = false;
showSlides(slideIndex, false);

function plusSlides(n) {
    if (isAnimating) return;
    isAnimating = true;
    
    let slides = document.getElementsByClassName("mySlides");
    let currentSlide = slideIndex - 1;
    let nextIndex = slideIndex + n;
    
    if (nextIndex > slides.length) { nextIndex = 1; }
    if (nextIndex < 1) { nextIndex = slides.length; }
    let nextSlide = nextIndex - 1;
    
    slideDirection = n;
    
    // Animate out current slide
    if (slideDirection > 0) {
        slides[currentSlide].classList.add('slide-out-left');
    } else {
        slides[currentSlide].classList.add('slide-out-right');
    }
    
    // Show and animate in next slide
    slides[nextSlide].style.display = "block";
    if (slideDirection > 0) {
        slides[nextSlide].classList.add('slide-in-right');
    } else {
        slides[nextSlide].classList.add('slide-in-left');
    }
    
    slideIndex = nextIndex;
    
    setTimeout(() => {
        slides[currentSlide].style.display = "none";
        slides[currentSlide].classList.remove('slide-out-left', 'slide-out-right');
        slides[nextSlide].classList.remove('slide-in-left', 'slide-in-right');
        isAnimating = false;
    }, 1500);
}

function showSlides(n, animate = true) {
    let slides = document.getElementsByClassName("mySlides");
    if (n > slides.length) { slideIndex = 1 }
    if (n < 1) { slideIndex = slides.length }
    
    for (let i = 0; i < slides.length; i++) { 
        slides[i].style.display = "none"; 
    }
    
    slides[slideIndex - 1].style.display = "block";
}

// Intersection Observer for section animations
const observerOptions = {
    threshold: 0.1,
    rootMargin: '0px'
};

const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
        if (entry.isIntersecting && entry.target.classList.contains('section')) {
            entry.target.classList.add('animate-in');
        }
    });
}, observerOptions);

// Observe only sections, not navbar or footer
document.querySelectorAll('.section').forEach(section => {
    observer.observe(section);
});
</script>



</body>
</html>
